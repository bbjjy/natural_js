<style>
.exap0600 .grid__ td {
	background-color: #fff;
}
</style>
<article class="exap0600 view-code">
	<h1>화면전환(페이징) 입력(C) 조회(R) 수정(U) 삭제(D) 예제</h1>
	<div class="intro">
		<p class="smallContTit">목록 화면과 입력 조회 수정 삭제 시 화면이 전환되는 예제 입니다.</p>
		<p class="smallContTit">N.pagination 와 N.grid 를 연동 하여 페이징을 합니다(클라이언트로 받아진 전체 데이터에 대한 페이징이며 서버단 페이징은 Pagination API 문서 참고).</p>
		<p class="smallContTit">서버와 연계되지 않은 UI 쪽 코딩 예제 입니다. 때문에 검색 조건으로 입력한 데이터는 그리드에 적용되지 않습니다. 서버쪽으로 전달되는 파라미터만 확인 바랍니다.</p>
	</div>

	<div id="subContext">
		<div class="searchBox">
			<ul>
				<li class="inputs">
					<label>Name<input id="name" type="text" data-validate='[["alphabet+integer"]]' /></label>
					<label>Gender<input id="gender" type="radio" /></label>
					<label>Eye Color<select id="eyeColor"><option>선택</option></select></label>
				</li>
				<li class="buttons">
					<a id="btnAdd" href="#" data-opts='{ "color": "green" }'>신규입력</a>
					<a id="btnSearch" href="#">조회</a>
				</li>
			</ul>
		</div>

		<table id="grid" class="grid">
			<colgroup>
				<col style="width: 50px;">
				<col style="width: 110px;">
				<col style="width: 170px;">
				<col style="width: 70px;">
				<col style="width: 70px;">
				<col style="width: 50px;">
				<col style="width: 100px;">
				<col style="width: 50px;">
				<col style="width: 900px;">
				<col style="width: 300px;">
			</colgroup>
			<thead>
				<tr>
					<th>index</th>
					<th>name</th>
					<th>email</th>
					<th>gender</th>
					<th>eye color</th>
					<th>age</th>
					<th>company</th>
					<th>active</th>
					<th>about</th>
					<th>greeting</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td id="index" align="center"></td>
					<td id="name"></td>
					<td id="email"></td>
					<td id="gender" align="center"></td>
					<td id="eyeColor" align="center"></td>
					<td id="age" align="center"></td>
					<td id="company"></td>
					<td id="isActive" align="center"></td>
					<td id="about"></td>
					<td id="greeting"></td>
				</tr>
			</tbody>
		</table>
		<div align="center">
			<div id="pagination">
				<ul>
					<li><a href="#" title="첫페이지">first</a></li>
					<li><a href="#" title="이전">prev</a></li>
				</ul>
				<ul>
					<li><a href="#"><span>1</span></a></li>
				</ul>
				<ul>
					<li><a href="#" title="다음페이지">next</a></li>
					<li><a href="#" title="마지막페이지">last</a></li>
				</ul>
			</div>
		</div>
	</div>
</article>

<script type="text/javascript">
N(".exap0600").cont({
	genderCodes : [{
     	"key" : "male",
     	"val" : "male"
     },{
     	"key" : "female",
     	"val" : "female"
    }],
	eyeColorCodes : [{
     	"key" : "blue",
     	"val" : "blue"
     },{
     	"key" : "brown",
     	"val" : "brown"
     },{
     	"key" : "green",
     	"val" : "green"
	}],
    init : function(view, request) {
    	// 1. initialize buttons
    	N(".buttons a", view).button();

    	// 2. initialize N.select and bind data for search box inputs
    	// 2-1. create #gender select
		N(this.genderCodes).select(N("div.searchBox li.inputs #gender", view)).bind();
		// 2-2. create #eyeColor select
		N(this.eyeColorCodes).select(N("div.searchBox li.inputs #eyeColor", view)).bind();

    	// 3. initialize N.form and add new row data for search box
    	var form = N([]).form({
    		context : N("div.searchBox li.inputs", view),
    		revert : true
    	});
    	if(request.attr("scData") === undefined) {
    		form.add();
    	} else {
    		form.bind(0, request.attr("scData"));
    	}

    	// 4. initialize N.grid and bind empty data for data list
    	var grid = N([]).grid({
       		context : N("#grid", view),
       		data : [],
       		resizable : true,
       		sortable : true,
       		hover : true,
       		select : true,
       		fixedcol : 2,
       		createRowDelay : 0,
       		onSelect : function(index, rowEle, data) {
       			// Grid row select event
            	N("#subContext", view).comm("html/exap/exap0601.html")
            		.request.attr("selData", [ data[index] ]) // send seleted row data
            			.request.attr("scData", form.data()) // send search condition data
            				.request.attr("pageNo", pagination.pageNo())
	            				.submit();
        	}
       	});

    	// 5. initialize N.pagination
    	var pagination = N().pagination({
			context : $("#pagination", view),
			onChange : function(pageNo, selEle, selData, currPageNavInfo) {
				// Data bind to N.grid
         		grid.bind(selData);
			}
		});

    	// 6. bind events
    	// 6-1. Search button
    	N("#btnSearch", view).click(function(e) {
            e.preventDefault();
            if(form.validate()) {
    			// Temporary code
    			N(form.data()).comm("html/apid/data/grid.json").submit(function(data) {
    				pagination.pageNo(request.attr("pageNo") !== undefined ? request.attr("pageNo") : 1).bind(data);
    				request.removeAttr("pageNo");
             	});
            }
        }).click(); // Auto retrieve

        // 6-2. Add button
    	N("#btnAdd", view).click(function(e) {
            e.preventDefault();
         // Grid row select event
        	N("#subContext", view).comm("html/exap/exap0602.html")
        		.request.attr("scData", form.data()) // send search condition data
        			.request.attr("pageNo", pagination.pageNo()) // send pagination's pageNo
        				.submit();
        });
    }
});
</script>